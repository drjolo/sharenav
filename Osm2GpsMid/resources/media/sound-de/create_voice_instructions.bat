set lang=
REM create wav files for all instructions using espeak from http://espeak.sf.net
espeak -a180 -w%lang%halb.wav -z -p79 -s180 -vde+f1 -x -k5 "halb"
espeak -a180 -w%lang%scharf.wav -z -p79 -s200 -vde+f1 -x -k5 "scharf"
espeak -a180 -w%lang%links.wav -z -p79 -s200 -vde+f1 -x -k5 "links"
espeak -a180 -w%lang%rechts.wav -z -p79 -s180 -vde+f1 -x -k5 "rechts"
espeak -a180 -w%lang%geradeaus.wav -z -p79 -s200 -vde+f1 -x -k5 "geradeaus"
espeak -a180 -w%lang%in.wav -z -p79 -s190 -vde+f1 -x -k5 "in"
espeak -a180 -w%lang%gleich.wav -z -p79 -s190 -vde+f1 -x -k5 "gleich"
REM espeak -a180 -w%lang%weiterhin.wav -z -p79 -s200 -vde+f1 -x -k5 "weiterhin"
espeak -a180 -w%lang%100.wav -z -p79 -s250 -vde+f1 -x -k5 "100"
espeak -a180 -w%lang%200.wav -z -p79 -s220 -vde+f1 -x -k5 "200"
espeak -a180 -w%lang%300.wav -z -p79 -s220 -vde+f1 -x -k5 "300"
espeak -a180 -w%lang%400.wav -z -p79 -s180 -vde+f1 -x -k5 "400"
espeak -a180 -w%lang%500.wav -z -p79 -s200 -vde+f1 -x -k5 "500"
espeak -a180 -w%lang%600.wav -z -p79 -s200 -vde+f1 -x -k5 "600"
espeak -a180 -w%lang%700.wav -z -p79 -s200 -vde+f1 -x -k5 "700"
espeak -a180 -w%lang%800.wav -z -p79 -s200 -vde+f1 -x -k5 "800"
espeak -a180 -w%lang%metern.wav -z -p79 -s200 -vde+f1 -x -k5 "Metern"
espeak -a180 -w%lang%dann.wav -z -p79 -s200 -vde+f1 -x -k5 "dann"
espeak -a180 -w%lang%bald.wav -z -p79 -s200 -vde+f1 -x -k5 "bald"
espeak -a180 -w%lang%nochmal.wav -z -p79 -s200 -vde+f1 -x -k5 "nochmal"
espeak -a180 -w%lang%zum.wav -z -p79 -s200 -vde+f1 -x -k5 "zum"
espeak -a180 -w%lang%auf_autobahn.wav -z -p79 -s200 -vde+f1 -x -k5 "auf die Autobahn fahren"
espeak -a180 -w%lang%die.wav -z -p79 -s200 -vde+f1 -x -k5 "die"
espeak -a180 -w%lang%autobahn_verlassen.wav -z -p79 -s200 -vde+f1 -x -k5 "Autobahn verlassen"
espeak -a180 -w%lang%in_den_tunnel.wav -z -p79 -s180 -vde+f1 -x -k5 "in den Tunnel!"
espeak -a180 -w%lang%aus_dem_tunnel.wav -z -p79 -s190 -vde+f1 -x -k5 "aus dem Tunnel!"
espeak -a180 -w%lang%im_kreisel.wav -z -p79 -s200 -vde+f1 -x -k5 "im Kreisel"
espeak -a180 -w%lang%nimm.wav -z -p79 -s200 -vde+f1 -x -k5 "nimm"
espeak -a180 -w%lang%1te.wav -z -p79 -s150 -vde+f1 -x -k5 "erste"
espeak -a180 -w%lang%2te.wav -z -p79 -s180 -vde+f1 -x -k5 "zweite"
espeak -a180 -w%lang%3te.wav -z -p79 -s150 -vde+f1 -x -k5 "dritte"
espeak -a180 -w%lang%4te.wav -z -p79 -s180 -vde+f1 -x -k5 "vierte"
espeak -a180 -w%lang%5te.wav -z -p79 -s180 -vde+f1 -x -k5 "fuenfte"
espeak -a180 -w%lang%6te.wav -z -p79 -s180 -vde+f1 -x -k5 "sechste"
espeak -a180 -w%lang%kreisel_abfahrt.wav -z -p79 -s200 -vde+f1 -x -k5 "Abfahrt"
espeak -a180 -w%lang%am_ziel.wav -z -p79 -s200 -vde+f1 -x -k5 "am Ziel angekommen"
espeak -a180 -w%lang%richtung_pruefen.wav -z -p79 -s200 -vde+f1 -x -k5 "Stimmt die Richtung?"
espeak -a180 -w%lang%neue_route.wav -z -p79 -s180 -vde+f1 -x -k5 "Die Route wird neu berechnet."
espeak -a180 -w%lang%geschwindigkeit.wav -z -p79 -s200 -vde+f1 -x -k5 "Bitte nicht zu schnell!"
espeak -a180 -w%lang%halten.wav -z -p79 -s150 -vde+f1 -x -k5 "halten"
espeak -a180 -w%lang%halte_dich.wav -z -p79 -s150 -vde+f1 -x -k5 "halte Dich"
espeak -a180 -w%lang%folge_strasse.wav -z -p79 -s200 -vde+f1 -x -k5 "Dem Strassenverlauf folgen"
espeak -a180 -w%lang%ueber_platz.wav -z -p79 -s150 -vde+f1 -x -k5 "ueber den Platz"
espeak -a180 -w%lang%platz_verlassen.wav -z -p79 -s150 -vde+f1 -x -k5 "den Platz verlassen"
espeak -a180 -w%lang%bitte.wav -z -p79 -s180 -vde+f1 -x -k5 "bitte"
espeak -a180 -w%lang%wenden.wav -z -p79 -s180 -vde+f1 -x -k5 "wenden"

REM resample and increase volume of all sounds using sox from http://sox.sf.net
FOR /F "tokens=*" %%i in ('dir /b *.wav') do (
	REM fix wav file
	sox "%%i" repair.wav
	REM resample it to 8kHz with 16 bits and single channel, increase volume by 10 limited dBs
	REM sox 14.3.0 is required for --guard option
	sox --guard repair.wav -b 16 -c 1 "%%i" rate -I 8k gain -l 10
	del repair.wav
)

REM Finally convert the wav-files to AMR format
REM GpsMid's standard sound files are at 4.75kbit/s which is the lowest possible bit rate

FOR /F "tokens=*" %%i in ('dir /b *.wav') do (
	REM *** use available amr converter ***
	REM is Sony Ericsson (TM) AMR converter (can't find url anymore) there?
	if exist converter.exe (
		converter.exe wav2amr "%%i" "tempor.amr" MR475
	) else (
	REM converter from http://retrocde.sf.net is there?
		if exist code.exe (
			code "%%i" "tempor.amr" -br 4750
		)
	)

	REM only update amr file if it has changed
	fc >nul /b tempor.amr "%%~ni.amr"
	if errorlevel 1 (
		copy tempor.amr "%%~ni.amr"
	)
	del tempor.amr

	REM http://lame.sf.net
	lame %%i tempor.mp3 -b 8
	REM only update mp3 file if it has changed
	fc >nul /b tempor.mp3 "%%~ni.mp3"
	if errorlevel 1 (
		copy tempor.mp3 "%%~ni.mp3"
	)
	del tempor.mp3


	echo %%i
)

